<%@ page language="java"
         import="java.util.*,com.zhuozhengsoft.pageoffice.*"
         pageEncoding="gb2312"%>
<%@ page import="com.jfinal.core.JFinal" %>
<%@ page import="com.zhuozhengsoft.pageoffice.wordwriter.WordDocument" %>
<%@ page import="com.zhuozhengsoft.pageoffice.wordwriter.Table" %>
<%@ page import="com.contact.utils.ParaUtils" %>
<%@ page import="com.contact.model.*" %>
<%@ taglib uri="http://java.pageoffice.cn" prefix="po"%>
<%
    PageOfficeCtrl poCtrl=new PageOfficeCtrl(request);
    //获取Request数据
    Delivery_OriginRecord delivery_originRecord = (Delivery_OriginRecord)request.getAttribute("delivery_originRecord");
    String path =delivery_originRecord.getStr("originRecord_path");
//设置服务器页面
    poCtrl.setServerPage(request.getContextPath()+"/poserver.zz");
    poCtrl.setFileTitle(delivery_originRecord.getStr("name"));
    poCtrl.setCaption(delivery_originRecord.getStr("name"));
//添加自定义按钮
    poCtrl.addCustomToolButton("保存","Save",1);
    poCtrl.addCustomToolButton("打印", "ShowPrintDlg()", 6);
    poCtrl.addCustomToolButton("-", "", 0);
    poCtrl.addCustomToolButton("全屏切换", "SwitchFullScreen()", 4);

    //设置保存页面
    //poCtrl.setSaveFilePage("/export/save?type=originRecord&&template_id="+originRecordTemplate.get("id")+"&&delivery_id="+delivery_id);
    //poCtrl.setSaveFilePage("/export/save");
    //设置页面
    //打开Word文档
    poCtrl.webOpen(path,OpenModeType.docReadOnly, ParaUtils.getCurrentUser(request)!=null?ParaUtils.getCurrentUser(request).getStr("name"):"佚名");
    poCtrl.setTagId("PageOfficeCtrl1");//此行必需
%>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/assets/images/favicon.png" type="image/png">
    <!--弹出层-->
    <link href="/assets/css/jquery.gritter.css" rel="stylesheet">
    <title>实验室信息管理系统</title>

    <link href="/assets/css/style.default.css" rel="stylesheet">

</head>
<body>
<div style=" width:auto; height:auto;">
    <po:PageOfficeCtrl id="PageOfficeCtrl1">
    </po:PageOfficeCtrl>
</div>


<script src="/assets/js/jquery-1.11.1.min.js"></script>
<!--弹出层-->
<script src="/assets/js/jquery.gritter.min.js"></script>
<script type="text/javascript">
    function Save() {
        var result = document.getElementById("PageOfficeCtrl1").ShowDialog(3);
        console.log(result);
        //document.getElementById("PageOfficeCtrl1").WebSave();
    }
    function ShowPrintDlg() {
        document.getElementById("PageOfficeCtrl1").ShowDialog(4); //打印对话框
    }
    function SwitchFullScreen() {
        document.getElementById("PageOfficeCtrl1").FullScreen = !document.getElementById("PageOfficeCtrl1").FullScreen;
    }
</script>
</body>
</html>
